<!--<!DOCTYPE html>
<html>
<head>
  <title>SmartMirror Display</title>
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
     <style>
    body {
      background: black;
      color: white;
      font-family: Arial, sans-serif;
      text-align: center;
      margin-top: 20%;
      font-size: 25px;
      transition: opacity 0.3s ease;
    }
    body.off {
      opacity: 0;
    }
    .weather-display {
      margin-top: 40px;
    }
    .weather-temp {
      font-size: 60px;
      font-weight: bold;
    }
    .weather-icon {
      width: 100px;
      height: 100px;
    }
    .calendar-display {
      margin-top: 40px;
      text-align: left;
      max-width: 800px;
      margin-left: auto;
      margin-right: auto;
    }
    .event-item {
      background: rgba(255, 255, 255, 0.1);
      padding: 15px;
      margin: 10px 0;
      border-radius: 8px;
    }
    .event-date {
      font-size: 18px;
      color: #4CAF50;
      font-weight: bold;
    }
    .event-title {
      font-size: 24px;
      margin: 5px 0;
    }
    .clock-display {
      text-align: center;
    }
    .time {
      font-size: 120px;
      font-weight: 300;
      letter-spacing: -5px;
      margin: 20px 0;
    }
    .date {
      font-size: 40px;
      font-weight: 300;
      color: #ccc;
      margin: 10px 0;
    }
    .day {
      font-size: 28px;
      color: #999;
      }
    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <div id="homeView" class="clock-display">
   <h1>View: <span id="view">home</span></h1>
<!--    <div class="time" id="clock">00:00</div>
    <div class="date" id="date">January 1, 2025</div>
    <div class="day" id="day">Monday</div>
    <br>
    <span id="message"></span>
  </div>

  <div id="weatherView" class="hidden weather-display">
  <h1>View: <span id="view">weather</span></h1>
    <h2 id="weatherCity"></h2>
    <div class="weather-temp"><span id="weatherTemp"></span>°C</div>
    <div style="font-size: 30px; margin: 20px 0;" id="weatherDesc"></div>
    <div style="font-size: 20px;">
      Feels like: <span id="weatherFeels"></span>°C | Humidity: <span id="weatherHumidity"></span>%
      <span id="message"></span>
    </div>
  </div>

   <div id="calendarView" class="hidden calendar-display">
   <h1>View: <span id="view">calendar</span></h1>
    <h2>Upcoming Events</h2>
    <div id="calendarEvents"></div>
    <span id="message"></span>
  </div>


  <script>
    // Connect to the backend via Socket.IO
    const socket = io();

    // Listen for updates
    socket.on('state_update', (state) => {
      document.getElementById('message').textContent = state.message;

      // Toggle display on/off
      if (state.display_on) {
        document.body.classList.remove('off');
      } else {
        document.body.classList.add('off');
      }
        // Brightness update
      if (state.brightness !== undefined) {
        // Expecting brightness to be 0–100
        const percent = Math.min(100, Math.max(0, state.brightness));
        // document.body.style.opacity = percent / 100;
        document.body.style.filter = `brightness(${percent}%)`;
      }

      // Show appropriate view
      const homeView = document.getElementById('homeView');
      const weatherView = document.getElementById('weatherView');
      const calendarView = document.getElementById('calendarView');

      // Hide all views first
      homeView.classList.add('hidden');
      weatherView.classList.add('hidden');
      calendarView.classList.add('hidden');


      if (state.view === 'weather' && state.weather) {
        weatherView.classList.remove('hidden');

        // Update weather data
        if (state.weather.error) {
          document.getElementById('weatherCity').textContent = 'Error loading weather';
          document.getElementById('weatherDesc').textContent = state.weather.error;
        } else {
          document.getElementById('weatherCity').textContent = state.weather.city;
          document.getElementById('weatherTemp').textContent = state.weather.temp;
          document.getElementById('weatherDesc').textContent = state.weather.description;
          document.getElementById('weatherFeels').textContent = state.weather.feels_like;
          document.getElementById('weatherHumidity').textContent = state.weather.humidity;
        }
      } else if (state.view === 'calendar' && state.calendar) {
        calendarView.classList.remove('hidden');
        // Update calendar data
        const eventsContainer = document.getElementById('calendarEvents');
        if (state.calendar.error) {
          eventsContainer.innerHTML = '<p>Error loading calendar: ' + state.calendar.error + '</p>';
        } else if (state.calendar.events && state.calendar.events.length > 0) {
          let html = '';
          state.calendar.events.forEach(event => {
            html += `
              <div class="event-item">
                <div class="event-date">${event.date} ${event.time !== 'All day' ? '- ' + event.time : '(All day)'}</div>
                <div class="event-title">${event.title}</div>
              </div>
            `;
          });
          eventsContainer.innerHTML = html;
        } else {
          eventsContainer.innerHTML = '<p>No upcoming events</p>';
        }
      } else {
        homeView.classList.remove('hidden');
      }
    });
  </script>
  <script>
  function updateClock() {
    const now = new Date();

    let hours = now.getHours();
    let minutes = now.getMinutes();

    // Format (e.g., 08:05)
    hours = hours.toString().padStart(2, '0');
    minutes = minutes.toString().padStart(2, '0');

    document.getElementById('clock').textContent = `${hours}:${minutes}`;

    // Format date
    const dateOptions = { year: 'numeric', month: 'long', day: 'numeric' };
    document.getElementById('date').textContent = now.toLocaleDateString(undefined, dateOptions);

    // Day of week
    const dayOptions = { weekday: 'long' };
    document.getElementById('day').textContent = now.toLocaleDateString(undefined, dayOptions);
  }
  // Update immediately
  updateClock();

  // Update every second
  setInterval(updateClock, 1000);
</script>

</body>
</html>-->

<!DOCTYPE html>
<html>
<head>
  <title>SmartMirror Display</title>
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>

  <style>
    body {
      background: black;
      color: white;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      height: 100vh;
      width: 100vw;
      overflow: hidden;
      position: relative;
      transition: opacity 0.3s ease;
    }

    body.off {
      opacity: 0;
    }

    /* CLOCK (center top-ish) */
    #homeView {
      position: absolute;
      top: 18%;
      left: 50%;
      transform: translateX(-50%);
      text-align: center;
    }

    .time {
      font-size: 120px;
      font-weight: 300;
      letter-spacing: -5px;
      margin: 0;
    }

    .date {
      font-size: 40px;
      font-weight: 300;
      color: #ccc;
      margin: 10px 0;
    }

    .day {
      font-size: 28px;
      color: #999;
    }

    /* MESSAGE under clock */
    #message {
      display: block;
      margin-top: 20px;
      font-size: 26px;
      color: #ccc;
      text-align: center;
    }

    /* WEATHER bottom-left */
    #weatherView {
      position: absolute;
      bottom: 5%;
      left: 5%;
      text-align: left;
    }

    .weather-temp {
      font-size: 60px;
      font-weight: bold;
    }

    /* CALENDAR bottom-right */
    #calendarView {
      position: absolute;
      bottom: 5%;
      right: 5%;
      text-align: left;
      max-width: 450px;
    }

    .event-item {
      background: rgba(255, 255, 255, 0.05);
      padding: 12px;
      margin: 8px 0;
      border-radius: 6px;
    }

    .event-date {
      font-size: 18px;
      color: #4CAF50;
      font-weight: bold;
    }

    .event-title {
      font-size: 22px;
      margin-top: 4px;
    }
  </style>
</head>

<body>

  <!-- CLOCK -->
  <div id="homeView">
    <div class="time" id="clock">00:00</div>
    <div class="date" id="date">January 1, 2025</div>
    <div class="day" id="day">Monday</div>
    <span id="message"></span>
  </div>

  <!-- WEATHER -->
  <div id="weatherView">
    <h2 id="weatherCity"></h2>
    <div class="weather-temp"><span id="weatherTemp"></span>°C</div>
    <div id="weatherDesc" style="font-size: 26px; margin: 10px 0;"></div>
    <div style="font-size: 20px;">
      Feels like: <span id="weatherFeels"></span>°C |
      Humidity: <span id="weatherHumidity"></span>%
    </div>
  </div>

  <!-- CALENDAR -->
  <div id="calendarView">
    <h2>Upcoming Events</h2>
    <div id="calendarEvents"></div>
  </div>

  <!-- SOCKET.IO + STATE UPDATES -->
  <script>
    const socket = io();

    socket.on('state_update', (state) => {
      // Message
      document.getElementById('message').textContent = state.message;

      // Display ON/OFF
      if (state.display_on) {
        document.body.classList.remove('off');
      } else {
        document.body.classList.add('off');
      }

      // Brightness
      if (state.brightness !== undefined) {
        const percent = Math.min(100, Math.max(0, state.brightness));
        document.body.style.filter = `brightness(${percent}%)`;
      }

      // WEATHER UPDATES
      if (state.weather) {
        if (state.weather.error) {
          document.getElementById('weatherCity').textContent = 'Error loading weather';
          document.getElementById('weatherDesc').textContent = state.weather.error;
        } else {
          document.getElementById('weatherCity').textContent = state.weather.city;
          document.getElementById('weatherTemp').textContent = state.weather.temp;
          document.getElementById('weatherDesc').textContent = state.weather.description;
          document.getElementById('weatherFeels').textContent = state.weather.feels_like;
          document.getElementById('weatherHumidity').textContent = state.weather.humidity;
        }
      }

      // CALENDAR UPDATES
      if (state.calendar) {
        const eventsContainer = document.getElementById('calendarEvents');
        if (state.calendar.error) {
          eventsContainer.innerHTML = '<p>Error loading calendar</p>';
        } else if (state.calendar.events?.length > 0) {
          eventsContainer.innerHTML = state.calendar.events.map(event => `
            <div class="event-item">
              <div class="event-date">
                ${event.date} ${event.time !== 'All day' ? '– '+event.time : '(All day)'}
              </div>
              <div class="event-title">${event.title}</div>
            </div>
          `).join('');
        } else {
          eventsContainer.innerHTML = '<p>No upcoming events</p>';
        }
      }
    });
  </script>

  <!-- LIVE CLOCK -->
  <script>
    function updateClock() {
      const now = new Date();
      let h = now.getHours().toString().padStart(2, '0');
      let m = now.getMinutes().toString().padStart(2, '0');

      document.getElementById('clock').textContent = `${h}:${m}`;

      const dateOptions = { year: 'numeric', month: 'long', day: 'numeric' };
      document.getElementById('date').textContent =
        now.toLocaleDateString(undefined, dateOptions);

      const dayOptions = { weekday: 'long' };
      document.getElementById('day').textContent =
        now.toLocaleDateString(undefined, dayOptions);
    }

    updateClock();
    setInterval(updateClock, 1000);
  </script>

</body>
</html>


